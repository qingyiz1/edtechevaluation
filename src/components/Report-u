<template>
  <b-container>
    <b-row align-h="center">
      <b-col cols="8">
        <b-card
          :header="'Generated from '+report.evaluationID.name"
          :title="report.name"
          :sub-title="'Created by '+report.reportAuthor"
          border-variant="primary"
          header-bg-variant="primary"
          header-text-variant="white"
          v-for="report in reportList"
          v-bind:key="report.id"
          class="text-left mt-3"
        >
          <b-card-text>
            <b-icon icon="calendar2-event"></b-icon>
            Created on {{getTime(report.dateCreated)}}
            <br />
            <b-icon icon="calendar-check"></b-icon>
            Edited on {{getTime(report.dateEdited)}}
          </b-card-text>
          <b-card-text>
            <h4>Recommendation</h4>
            <p>{{report.recommendation}}</p>
            <p>
              Recommended by
              <em>{{report.recommendationAuthor}}</em>
            </p>
          </b-card-text>

          <b-container>
            <b-row>
              <b-col cols="9">
                <b-link class="card-link" @click="deleteReport(report.id)">Delete</b-link>
                <b-link
                  class="card-link"
                  href="https://firebasestorage.googleapis.com/v0/b/ee---echidna---2020.appspot.com/o/image%2F1111.docx?alt=media&token=85460805-33d1-4f1f-9bea-3f0f7471cdff"
                  download="filename"
                >Download</b-link>
                <b-link class="card-link">Send</b-link>
              </b-col>
              <b-col cols="3">
                <b-form-checkbox
                  v-model="report.isCompleted"
                  name="check-button"
                  switch
                  @change="toggleIsComplete(report.id, report.isCompleted)"
                >{{report.isCompleted?'completed':'uncompleted'}}</b-form-checkbox>
              </b-col>
            </b-row>
          </b-container>
        </b-card>
      </b-col>
    </b-row>
  </b-container>
</template>

<script>
import { deleteDocument, updateDocument } from "@/tools/firebaseTool";
import { reportCollection } from "@/tools/firebaseConfig";
// import * as firebase from "firebase";
export default {
  name: "Reports",
  data() {
    return {
      reportList: [],
      file1: null,
    };
  },
  methods: {
    deleteReport(reportId) {
      deleteDocument("report", reportId);
    },
    getTime: function (rawDate) {
      let m = new Date(rawDate.seconds * 1000);
      return m.toLocaleString();
    },
    toggleIsComplete: function (id, isCompleted) {
      console.log(id, isCompleted);
      updateDocument("report", id, {
        isCompleted: !isCompleted,
      });
    },
 },
  firestore: {
    reportList: reportCollection,
  },
};
</script>



<style scoped>
</style>

// test